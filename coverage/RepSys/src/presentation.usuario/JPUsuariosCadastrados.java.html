<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>JPUsuariosCadastrados.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">AllTests (10/05/2012 06:09:34)</a> &gt; <a href="../../index.html" class="el_group">RepSys</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.html" class="el_package">presentation.usuario</a> &gt; <span class="el_source">JPUsuariosCadastrados.java</span></div><h1>JPUsuariosCadastrados.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">/*</span>
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * JPUsuariosCadastrados.java
 *
 * Created on 07/05/2012, 00:26:59
 */
package presentation.usuario;

import business.BusinessException;
import business.BusinessFactory;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.ListSelectionModel;
import javax.swing.table.DefaultTableModel;
import presentation.desktop.MainWindow;
import presentation.lib.IMultiModePanel;
import vo.UsuarioVO;

/**
 *
 * @author Endril
 */
public class JPUsuariosCadastrados extends javax.swing.JPanel implements presentation.lib.ReturnEvent,IMultiModePanel{

    /** Creates new form JPUsuariosCadastrados */
<span class="nc" id="L33">    public JPUsuariosCadastrados() {</span>
<span class="nc" id="L34">        initComponents();</span>
<span class="nc" id="L35">        populaTabela();</span>
<span class="nc" id="L36">        this.setMode(Mode.NORMAL);</span>
<span class="nc" id="L37">    }</span>
    
<span class="nc" id="L39">    public JPUsuariosCadastrados(Mode mode) {</span>
<span class="nc" id="L40">        initComponents();</span>
<span class="nc" id="L41">        populaTabela();</span>
<span class="nc" id="L42">        this.setMode(mode);</span>
<span class="nc" id="L43">    }</span>

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot;Generated Code&quot;&gt;//GEN-BEGIN:initComponents
    private void initComponents() {

<span class="nc" id="L54">        jLabel1 = new javax.swing.JLabel();</span>
<span class="nc" id="L55">        buttonVoltar = new javax.swing.JButton();</span>
<span class="nc" id="L56">        jSeparator1 = new javax.swing.JSeparator();</span>
<span class="nc" id="L57">        jScrollPane1 = new javax.swing.JScrollPane();</span>
<span class="nc" id="L58">        jTable1 = new javax.swing.JTable();</span>
<span class="nc" id="L59">        buttonRemover = new javax.swing.JButton();</span>
<span class="nc" id="L60">        buttonConfirmarSelecao = new javax.swing.JButton();</span>
<span class="nc" id="L61">        buttonEditar = new javax.swing.JButton();</span>

<span class="nc" id="L63">        jLabel1.setFont(new java.awt.Font(&quot;Cambria&quot;, 1, 30));</span>
<span class="nc" id="L64">        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle(&quot;I18n/Bundle&quot;); // NOI18N</span>
<span class="nc" id="L65">        jLabel1.setText(bundle.getString(&quot;JPUsuariosCadastrados.jLabel1.text&quot;)); // NOI18N</span>

<span class="nc" id="L67">        buttonVoltar.setFont(new java.awt.Font(&quot;Calibri&quot;, 1, 12));</span>
<span class="nc" id="L68">        buttonVoltar.setText(bundle.getString(&quot;JPUsuariosCadastrados.buttonVoltar.text&quot;)); // NOI18N</span>
<span class="nc" id="L69">        buttonVoltar.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L71">                buttonVoltarActionPerformed(evt);</span>
<span class="nc" id="L72">            }</span>
        });

<span class="nc" id="L75">        jTable1.setFont(new java.awt.Font(&quot;Calibri&quot;, 1, 12)); // NOI18N</span>
<span class="nc" id="L76">        jTable1.setModel(new javax.swing.table.DefaultTableModel(</span>
<span class="nc" id="L77">            new Object [][] {</span>

            },
<span class="nc" id="L80">            new String [] {</span>
<span class="nc" id="L81">                &quot;Usu√°rio&quot;, &quot;E-mail&quot;</span>
            }
        ) {
<span class="nc" id="L84">            boolean[] canEdit = new boolean [] {</span>
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
<span class="nc" id="L89">                return canEdit [columnIndex];</span>
            }
        });
<span class="nc" id="L92">        jTable1.getTableHeader().setReorderingAllowed(false);</span>
<span class="nc" id="L93">        jScrollPane1.setViewportView(jTable1);</span>
<span class="nc" id="L94">        jTable1.getColumnModel().getColumn(0).setHeaderValue(bundle.getString(&quot;JPUsuariosCadastrados.jTable1.columnModel.title0&quot;)); // NOI18N</span>
<span class="nc" id="L95">        jTable1.getColumnModel().getColumn(1).setHeaderValue(bundle.getString(&quot;JPUsuariosCadastrados.jTable1.columnModel.title1&quot;)); // NOI18N</span>

<span class="nc" id="L97">        buttonRemover.setFont(new java.awt.Font(&quot;Calibri&quot;, 1, 12));</span>
<span class="nc" id="L98">        buttonRemover.setText(bundle.getString(&quot;JPUsuariosCadastrados.buttonRemover.text&quot;)); // NOI18N</span>
<span class="nc" id="L99">        buttonRemover.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L101">                buttonRemoverActionPerformed(evt);</span>
<span class="nc" id="L102">            }</span>
        });

<span class="nc" id="L105">        buttonConfirmarSelecao.setFont(new java.awt.Font(&quot;Calibri&quot;, 1, 12));</span>
<span class="nc" id="L106">        buttonConfirmarSelecao.setText(bundle.getString(&quot;JPUsuariosCadastrados.buttonConfirmarSelecao.text&quot;)); // NOI18N</span>
<span class="nc" id="L107">        buttonConfirmarSelecao.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L109">                buttonConfirmarSelecaoActionPerformed(evt);</span>
<span class="nc" id="L110">            }</span>
        });

<span class="nc" id="L113">        buttonEditar.setFont(new java.awt.Font(&quot;Calibri&quot;, 1, 12));</span>
<span class="nc" id="L114">        buttonEditar.setText(bundle.getString(&quot;JPUsuariosCadastrados.buttonEditar.text&quot;)); // NOI18N</span>
<span class="nc" id="L115">        buttonEditar.addActionListener(new java.awt.event.ActionListener() {</span>
            public void actionPerformed(java.awt.event.ActionEvent evt) {
<span class="nc" id="L117">                buttonEditarActionPerformed(evt);</span>
<span class="nc" id="L118">            }</span>
        });

<span class="nc" id="L121">        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);</span>
<span class="nc" id="L122">        this.setLayout(layout);</span>
<span class="nc" id="L123">        layout.setHorizontalGroup(</span>
<span class="nc" id="L124">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L125">            .addGroup(layout.createSequentialGroup()</span>
<span class="nc" id="L126">                .addContainerGap()</span>
<span class="nc" id="L127">                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L128">                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 504, Short.MAX_VALUE)</span>
<span class="nc" id="L129">                    .addComponent(jSeparator1, javax.swing.GroupLayout.DEFAULT_SIZE, 504, Short.MAX_VALUE)</span>
<span class="nc" id="L130">                    .addComponent(jLabel1)</span>
<span class="nc" id="L131">                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()</span>
<span class="nc" id="L132">                        .addComponent(buttonRemover)</span>
<span class="nc" id="L133">                        .addGap(18, 18, 18)</span>
<span class="nc" id="L134">                        .addComponent(buttonEditar)</span>
<span class="nc" id="L135">                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 182, Short.MAX_VALUE)</span>
<span class="nc" id="L136">                        .addComponent(buttonConfirmarSelecao)</span>
<span class="nc" id="L137">                        .addGap(18, 18, 18)</span>
<span class="nc" id="L138">                        .addComponent(buttonVoltar)))</span>
<span class="nc" id="L139">                .addContainerGap())</span>
        );
<span class="nc" id="L141">        layout.setVerticalGroup(</span>
<span class="nc" id="L142">            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)</span>
<span class="nc" id="L143">            .addGroup(layout.createSequentialGroup()</span>
<span class="nc" id="L144">                .addComponent(jLabel1)</span>
<span class="nc" id="L145">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="nc" id="L146">                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L147">                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)</span>
<span class="nc" id="L148">                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 274, javax.swing.GroupLayout.PREFERRED_SIZE)</span>
<span class="nc" id="L149">                .addGap(31, 31, 31)</span>
<span class="nc" id="L150">                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)</span>
<span class="nc" id="L151">                    .addComponent(buttonVoltar)</span>
<span class="nc" id="L152">                    .addComponent(buttonRemover)</span>
<span class="nc" id="L153">                    .addComponent(buttonConfirmarSelecao)</span>
<span class="nc" id="L154">                    .addComponent(buttonEditar))</span>
<span class="nc" id="L155">                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))</span>
        );
<span class="nc" id="L157">    }// &lt;/editor-fold&gt;//GEN-END:initComponents</span>

private void buttonRemoverActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonRemoverActionPerformed
// TODO add your handling code here:
<span class="nc bnc" id="L161" title="All 2 branches missed.">    if(this.mode == Mode.NORMAL){</span>
        try{
<span class="nc" id="L163">            this.chamarRemocao();</span>
        }
<span class="nc" id="L165">        catch(BusinessException e){</span>
<span class="nc" id="L166">            JOptionPane.showMessageDialog(this, &quot;erro:&quot;+e.toString());</span>
        }            
    }
<span class="nc" id="L169">}//GEN-LAST:event_buttonRemoverActionPerformed</span>

private void buttonConfirmarSelecaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonConfirmarSelecaoActionPerformed
// TODO add your handling code here:
<span class="nc bnc" id="L173" title="All 2 branches missed.">    if(this.mode == Mode.SELECIONAVEL)</span>
<span class="nc" id="L174">        this.retornarUsuarioSelecionado();</span>
<span class="nc" id="L175">}//GEN-LAST:event_buttonConfirmarSelecaoActionPerformed</span>

private void buttonVoltarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonVoltarActionPerformed
// TODO add your handling code here:
<span class="nc" id="L179">    MainWindow.getInstance().closeCurrentCard();</span>
<span class="nc" id="L180">}//GEN-LAST:event_buttonVoltarActionPerformed</span>

private void buttonEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buttonEditarActionPerformed
// TODO add your handling code here:
<span class="nc bnc" id="L184" title="All 2 branches missed.">    if(this.mode == Mode.NORMAL)</span>
<span class="nc" id="L185">        this.chamarEdicao();</span>
<span class="nc" id="L186">}//GEN-LAST:event_buttonEditarActionPerformed</span>

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton buttonConfirmarSelecao;
    private javax.swing.JButton buttonEditar;
    private javax.swing.JButton buttonRemover;
    private javax.swing.JButton buttonVoltar;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JTable jTable1;
    // End of variables declaration//GEN-END:variables

    private Mode mode;
    private List&lt;UsuarioVO&gt; usuarios;
    
    public void onReturnFromOtherWindow(Object returnedObject) {
<span class="nc" id="L203">    }</span>

    public Mode getMode() {
<span class="nc" id="L206">        return this.mode;</span>
    }

    public void setMode(Mode newMode) {
        
<span class="nc" id="L211">        this.mode = newMode;</span>
        
<span class="nc bnc" id="L213" title="All 3 branches missed.">        switch (this.mode){</span>
            case NORMAL:
<span class="nc" id="L215">                this.buttonEditar.setEnabled(true);</span>
<span class="nc" id="L216">                this.buttonRemover.setEnabled(true);</span>
<span class="nc" id="L217">                this.jTable1.setRowSelectionAllowed(false);</span>
<span class="nc" id="L218">                this.jTable1.setColumnSelectionAllowed(false);</span>
<span class="nc" id="L219">                this.jTable1.setCellSelectionEnabled(false);</span>
<span class="nc" id="L220">                break;</span>
            case SELECIONAVEL:
<span class="nc" id="L222">                this.buttonEditar.setEnabled(false);</span>
<span class="nc" id="L223">                this.buttonRemover.setEnabled(false);</span>
<span class="nc" id="L224">                this.jTable1.setRowSelectionAllowed(true);</span>
<span class="nc" id="L225">                this.jTable1.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);</span>
<span class="nc" id="L226">                this.jTable1.setColumnSelectionAllowed(false);</span>
<span class="nc" id="L227">                this.jTable1.setCellSelectionEnabled(false);</span>
                break;
        }
<span class="nc" id="L230">    }</span>
    
    private void retornarUsuarioSelecionado(){
<span class="nc" id="L233">        MainWindow.getInstance().closeCurrentCard(usuarios.get((this.jTable1.getSelectedRow())));</span>
<span class="nc" id="L234">    }</span>

    private void chamarEdicao() {
<span class="nc" id="L237">        MainWindow.getInstance().showCard(this, new JPAtualizarUsuario(usuarios.get((this.jTable1.getSelectedRow()))));</span>
<span class="nc" id="L238">    }</span>

    private void chamarRemocao() throws BusinessException {
<span class="nc" id="L241">        UsuarioVO selecionado = usuarios.get((this.jTable1.getSelectedRow()));</span>
<span class="nc" id="L242">        BusinessFactory factory = BusinessFactory.getInstance();</span>
        try{
<span class="nc" id="L244">            factory.getUsuario().delete(selecionado.getEmail());</span>
        }
<span class="nc" id="L246">        catch(BusinessException e){</span>
<span class="nc" id="L247">            throw e;</span>
        }
<span class="nc" id="L249">    }</span>

    private void populaTabela(){
<span class="nc" id="L252">        usuarios = new ArrayList&lt;UsuarioVO&gt;();</span>
<span class="nc" id="L253">        BusinessFactory factory = BusinessFactory.getInstance();</span>
        
        try {
<span class="nc" id="L256">            usuarios = factory.getUsuario().getAll();</span>
<span class="nc" id="L257">        } catch (BusinessException ex) {</span>
<span class="nc" id="L258">            Logger.getLogger(JPUsuariosCadastrados.class.getName()).log(Level.SEVERE, null, ex);</span>
        }
        
<span class="nc" id="L261">        int counter=0;</span>
<span class="nc" id="L262">        DefaultTableModel model = (DefaultTableModel) jTable1.getModel();</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">        for (UsuarioVO usuario:usuarios) {</span>
<span class="nc" id="L264">            model.insertRow(counter, new Object[]{usuario.getNome(),usuario.getEmail()});</span>
<span class="nc" id="L265">            counter++;</span>
        }
<span class="nc" id="L267">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.5.6.201201232323</span>AllTests (10/05/2012 06:09:34)</div></body></html>